{% load static %}

<!DOCTYPE html>
<html lang="en">
  <!-- HEADER / LINKS /  BASIC SCRIPTS -->
  {% include '_partials/header.html' %}
  <!-- END HEADER / LINKS /  BASIC SCRIPTS -->
  <body>
    <div class="wrapper">
      <!-- Sidebar -->
      {% include '_partials/sidebar.html' %}
      <!-- End Sidebar -->

      <div class="main-panel">
        <!-- NAV BAR AND LOGO DIV -->
        {% include '_partials/navbar.html' %}
        <!-- END NAV BAR AND LOGO DIV -->

        <div class="container">
          <div class="page-inner">
            
          <div class="page-header">
              <h3 class="fw-bold mb-3">MAIN TITLE</h3>
              <ul class="breadcrumbs mb-3">
                <li class="nav-home">
                  <a href="#">
                    <i class="icon-home"></i>
                  </a>
                </li>
                <li class="separator">
                  <i class="icon-arrow-right"></i>
                </li>
                <li class="nav-item">
                  <a href="#">TITLE</a>
                </li>
                <li class="separator">
                  <i class="icon-arrow-right"></i>
                </li>
                <li class="nav-item">
                  <a href="#">SUB TITLE EXPLANATION</a>
                </li>
              </ul>
            </div>
          </div>
          
          {% block content %}
  
          {% endblock content %}
        </div>

        {% include '_partials/footer.html' %}
      </div>
      <script>
        // Function to generate random colors
        function generateColors(count) {
            const colors = [];
            for (let i = 0; i < count; i++) {
                const r = Math.floor(Math.random() * 255);
                const g = Math.floor(Math.random() * 255);
                const b = Math.floor(Math.random() * 255);
                colors.push(`rgba(${r}, ${g}, ${b}, 0.9)`);
            }
            return colors;
        }

        // Gender Distribution Pie Chart
        const genderCtx = document.getElementById('genderChart').getContext('2d');
        const genderChart = new Chart(genderCtx, {
            type: 'pie',
            data: {
                labels: {{ gender_labels|safe }},
                datasets: [{
                    label: 'Gender Distribution',
                    data: {{ gender_counts|safe }},
                    backgroundColor: generateColors({{ gender_labels|length }}),
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                }
            }
        });

        // Age Distribution Bar Chart
        const ageCtx = document.getElementById('ageChart').getContext('2d');
        const ageChart = new Chart(ageCtx, {
            type: 'bar',
            data: {
                labels: {{ age_labels|safe }},
                datasets: [{
                    label: 'Age Distribution',
                    data: {{ age_counts|safe }},
                    backgroundColor: 'rgba(75, 192, 192, 0.6)',
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Region Distribution Line Chart
        const regionCtx = document.getElementById('regionChart').getContext('2d');
        const regionChart = new Chart(regionCtx, {
            type: 'line',
            data: {
                labels: {{ region_labels|safe }},
                datasets: [{
                    label: 'Region Distribution',
                    data: {{ region_counts|safe }},
                    borderColor: 'rgba(153, 102, 255, 0.6)',
                    fill: false,
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Print Functionality
        document.getElementById('printReportBtn').addEventListener('click', function() {
            window.print();
        });

        // Populate Date and Time
        const date = new Date();
        const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        document.getElementById('dateMonth').textContent = months[date.getMonth()];
        document.getElementById('dateDay').textContent = date.getDate();
        document.getElementById('dateYear').textContent = date.getFullYear();
        document.getElementById('dateHours').textContent = date.getHours() % 12 || 12;
        document.getElementById('dateMinutes').textContent = String(date.getMinutes()).padStart(2, '0');
        document.getElementById('dateNoon').textContent = date.getHours() >= 12 ? 'PM' : 'AM';
    </script>
    </div>
    {% include '_partials/scripts.html' %}
  </body>
  <script>
        const ctx = document.getElementById('mattypeChart').getContext('2d');
        const mattypeChart = new Chart(ctx, {
            type: 'bar',  // You can change this to 'pie', 'line', etc.
            data: {
                labels: {{ mattype_labels|safe }},
                datasets: [{
                    label: 'Mattress Type Distribution',
                    data: {{ mattype_counts|safe }},
                    backgroundColor: [
                        'rgba(255, 99, 132, 0.6)',
                        'rgba(54, 162, 235, 0.6)',
                        'rgba(255, 206, 86, 0.6)',
                        'rgba(75, 192, 192, 0.6)',
                        'rgba(153, 102, 255, 0.6)',
                    ],
                }]
            },
            options: {
              responsive: true,
              scales: {
                  y: {
                      beginAtZero: true
                  }
              }
          }
      });
    </script>
</html>
