{% extends '_partials/adminBase.html' %}
{% load static %}

<!DOCTYPE html>
<html lang="en">
    {% block content %}
  
    <body>
        <h1 class="text-center my-4">Survey Data Visualizations</h1>

    
    <!-- Report Container -->
    <div id="reportDiv" class="container" style="background-color: white;">
        <!-- Age Distribution -->
        <hr class="my-2" />
        <div class="row">
            <div class="col-12 col-xl-12 col-sm-12 text-center">
                <div class="pgNbCircle sunrize text-center">2</div>
            </div>
            <div class="col-12 col-xl-6 col-sm-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title text-center h3 text-primary">Age Distribution</h5>
                        <h5 class="card-subtitle text-center text-muted">Total Records: <strong class="text-danger">{{ total_records }}</strong></h5>
                    </div>
                    <table id="ageDistribution" class="table table-striped table-sm">
                        <thead>
                            <tr>
                                <th>Age Group</th>
                                <th>Count</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for age, count in age_data.items %}
                            <tr>
                                <td>{{ age }}</td>
                                <td>{{ count }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="col-12 col-lg-6 col-sm-6">
                <div class="card">
                    <div class="card-header">
                        <h5 class="card-title text-primary text-center strong">Age Distribution Visualization</h5>
                    </div>
                    <div class="card-body">
                        <div class="chart">
                            <canvas id="ageChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Region Distribution -->
        <hr class="my-2" />
        <!-- Footer -->
        <hr class="my-2" />
        <div class="row pb-6 ml-4">
            <div class="col-md-6 col-sm-6">
                {% comment %} <div class="text-muted">Generated By {{ request.user.first_name }} {{ request.user.last_name }}</div> {% endcomment %}
                <strong>Marketing Director</strong>
            </div>
        </div>
    </div>
    
</body>
<script>
    function generateColors(count) {
      const colors = [];
      for (let i = 0; i < count; i++) {
          const r = Math.floor(Math.random() * 255);
          const g = Math.floor(Math.random() * 255);
          const b = Math.floor(Math.random() * 255);
          colors.push(`rgba(${r}, ${g}, ${b}, 0.9)`);
      }
      return colors;
  }

  const ageCtx = document.getElementById('ageChart').getContext('2d');
const ageChart = new Chart(ageCtx, { // Changed ctx to ageCtx
    type: 'bar',
    data: {
        labels: {{ age_labels|safe }},
        datasets: [{
            label: 'Age Distribution',
            data: {{ age_counts|safe }},
            backgroundColor: [
                'rgba(255, 99, 132, 0.6)',
                'rgba(54, 162, 235, 0.6)',
                'rgba(255, 206, 86, 0.6)',
                'rgba(75, 192, 192, 0.6)',
                'rgba(153, 102, 255, 0.6)',
            ],
        }]
    },
    options: {
        responsive: true,
        scales: {
            y: {
                beginAtZero: true
            }
        }
    }
});

  </script>
</html>
        {% endblock content %}